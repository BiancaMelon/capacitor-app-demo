# CapacitorAppDemo

This project tests the setup required to create an app using capacitor and angular.

[Capacitor](https://capacitorjs.com/) is a cross-platform native runtime for web apps. [Ionic](https://ionicframework.com/) is a UI web framework that accompanies capacitor and gives you access to useful native modules, including UI components and native functionality. Ionic integrates well with other frameworks, like angular.

## Development Setup Steps

### Install Node.js LTS

Download the binaries from [node.js](https://nodejs.org/en/download/) and follow the installer steps. If preferred, you can use alternative tools, like [n](https://www.npmjs.com/package/n) or [nvm](https://github.com/nvm-sh/nvm#installing-and-updating) to manage multiple node version.

Make sure you have node.js v20.11.1 installed:

```shell
node --version
> v20.11.1
```

### Install Angular 17

Now that node and npm is installed, install angular 17. For this project we will use the latest version of angular (17.2.3). For a refresher on angular CLI commands go [here](https://angular.io/cli).

```shell
npm install -g @angular/cli
ng version
```

Run `ng serve` for a dev server. Navigate to `http://localhost:4200/`. The application will automatically reload if you change any of the source files.

Run `ng generate component component-name` to generate a new component. You can also use `ng generate directive|pipe|service|class|guard|interface|enum|module`.

Run `ng build` to build the project. The build artifacts will be stored in the `dist/` directory.

### Install Capacitor with the Angular Framework

Capacitor can work with the Angular Framework. For install steps for capacitor with angular, see the official website [here](https://capacitorjs.com/solution/angular). For the developer workflow guide see the official website [here](https://capacitorjs.com/docs/basics/workflow) (would recommend, this is a very good guide).

For the TL;DR version see below.

```shell
ng add @capacitor/angular
```

You can now install support for the native platforms you want to target. In our case that is android and ios.

```shell
npm i @capacitor/ios @capacitor/android
```

You can now create native projects to translate your code to the target platforms.

``` shell
npx cap add android
npx cap add ios
```

After building your app with angular-cli, you need to sync the code with your native app projects using the sync command. For this to work, I had to update the webDir path in [capacitor.config.ts](./capacitor.config.ts) to `'dist/capacitor-app-demo/browser/'`.

```shell
ng build
npx cap sync
```

To test your app on an android or ios device, run either of the following commands. For android, this will open the device emulator installed with Android Studio by itself.

```shell
npx cap run android
npx cap run ios
```

To run the native IDE for the platform, which is either Android Studio or XCode (see install guides below), run either of the following commands.

```shell
npx cap open android
npx cap open ios
```

### Instal Android Studio

Install the [Android Studio Iguana IDE](https://developer.android.com/studio) to compile and test the native android code generated by capacitor. This will take a while, it is a sizeable application.

Once you open the capacitor-created project in Android Studio, you need to build your native code before you can run your app (personal note: android studio is slow). After that, you can run your native app using the Android device emulator.

If your setup experience is anything like mine, you'll start running into some issues here. There is a handy [troubleshooting guide](https://capacitorjs.com/docs/android/troubleshooting) on the capacitor official website.

In my case, I had to change the path to Gradle JDK. You can find that configuration under File > Settings (on Windows) and then Build, Execution, Deployment > Build Tools > Gradle and then change the Gradle JDK path to jbr-17. To ensure that the app can be run using capacitor `npx cap run android`, add a System environment variable (Windows) to point to the jbr directory, which was `JAVA_HOME='C:\Program Files\Android\Android Studio\jbr'` in my case. See the [Error: "Unable to locate a Java Runtime"](https://capacitorjs.com/docs/android/troubleshooting#error-unable-to-locate-a-java-runtime) section for more information.

### (Mac users) Install XCode

Install XCode to test the native iOS code. I can't give you steps for that because Mac, but I believe you can find it on the iStore/Mac App Store/whatever they call it. You'd also need to build the app in XCode, but the how-to I'll leave up to you.

### Install Ionic into an existing Angular app

First install the latest @ionic/angular package from npm, then add ionic using the angular-cli.

```shell
npm install -g @ionic/angular@latest
ng add @ionic/angular
```
